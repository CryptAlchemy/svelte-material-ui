class n{constructor(t,s){s=Object.assign({},n.defaults,s),this.element=t,this.opts=s,this.touchStartX=null,this.touchStartY=null,this.touchEndX=null,this.touchEndY=null,this.velocityX=null,this.velocityY=null,this.longPressTimer=null,this.doubleTapWaiting=!1,this.handlers={panstart:[],panmove:[],panend:[],swipeleft:[],swiperight:[],swipeup:[],swipedown:[],tap:[],doubletap:[],longpress:[]},this._onTouchStart=this.onTouchStart.bind(this),this._onTouchMove=this.onTouchMove.bind(this),this._onTouchEnd=this.onTouchEnd.bind(this),this.element.addEventListener("touchstart",this._onTouchStart,o),this.element.addEventListener("touchmove",this._onTouchMove,o),this.element.addEventListener("touchend",this._onTouchEnd,o),this.opts.mouseSupport&&!("ontouchstart"in window)&&(this.element.addEventListener("mousedown",this._onTouchStart,o),document.addEventListener("mousemove",this._onTouchMove,o),document.addEventListener("mouseup",this._onTouchEnd,o))}destroy(){this.element.removeEventListener("touchstart",this._onTouchStart),this.element.removeEventListener("touchmove",this._onTouchMove),this.element.removeEventListener("touchend",this._onTouchEnd),this.element.removeEventListener("mousedown",this._onTouchStart),document.removeEventListener("mousemove",this._onTouchMove),document.removeEventListener("mouseup",this._onTouchEnd),clearTimeout(this.longPressTimer),clearTimeout(this.doubleTapTimer)}on(t,s){if(this.handlers[t])return this.handlers[t].push(s),{type:t,fn:s,cancel:()=>this.off(t,s)}}off(t,s){if(this.handlers[t]){const e=this.handlers[t].indexOf(s);e!==-1&&this.handlers[t].splice(e,1)}}fire(t,s){for(let e=0;e<this.handlers[t].length;e++)this.handlers[t][e](s)}onTouchStart(t){this.thresholdX=this.opts.threshold("x",this),this.thresholdY=this.opts.threshold("y",this),this.disregardVelocityThresholdX=this.opts.disregardVelocityThreshold("x",this),this.disregardVelocityThresholdY=this.opts.disregardVelocityThreshold("y",this),this.touchStartX=t.type==="mousedown"?t.screenX:t.changedTouches[0].screenX,this.touchStartY=t.type==="mousedown"?t.screenY:t.changedTouches[0].screenY,this.touchMoveX=null,this.touchMoveY=null,this.touchEndX=null,this.touchEndY=null,this.longPressTimer=setTimeout(()=>this.fire("longpress",t),this.opts.longPressTime),this.fire("panstart",t)}onTouchMove(t){if(t.type==="mousemove"&&(!this.touchStartX||this.touchEndX!==null))return;const s=(t.type==="mousemove"?t.screenX:t.changedTouches[0].screenX)-this.touchStartX;this.velocityX=s-this.touchMoveX,this.touchMoveX=s;const e=(t.type==="mousemove"?t.screenY:t.changedTouches[0].screenY)-this.touchStartY;this.velocityY=e-this.touchMoveY,this.touchMoveY=e;const i=Math.abs(this.touchMoveX),h=Math.abs(this.touchMoveY);this.swipingHorizontal=i>this.thresholdX,this.swipingVertical=h>this.thresholdY,this.swipingDirection=i>h?this.swipingHorizontal?"horizontal":"pre-horizontal":this.swipingVertical?"vertical":"pre-vertical",Math.max(i,h)>this.opts.pressThreshold&&clearTimeout(this.longPressTimer),this.fire("panmove",t)}onTouchEnd(t){if(t.type==="mouseup"&&(!this.touchStartX||this.touchEndX!==null))return;this.touchEndX=t.type==="mouseup"?t.screenX:t.changedTouches[0].screenX,this.touchEndY=t.type==="mouseup"?t.screenY:t.changedTouches[0].screenY,this.fire("panend",t),clearTimeout(this.longPressTimer);const s=this.touchEndX-this.touchStartX,e=Math.abs(s),i=this.touchEndY-this.touchStartY,h=Math.abs(i);e>this.thresholdX||h>this.thresholdY?(this.swipedHorizontal=this.opts.diagonalSwipes?Math.abs(s/i)<=this.opts.diagonalLimit:e>=h&&e>this.thresholdX,this.swipedVertical=this.opts.diagonalSwipes?Math.abs(i/s)<=this.opts.diagonalLimit:h>e&&h>this.thresholdY,this.swipedHorizontal&&(s<0?(this.velocityX<-this.opts.velocityThreshold||s<-this.disregardVelocityThresholdX)&&this.fire("swipeleft",t):(this.velocityX>this.opts.velocityThreshold||s>this.disregardVelocityThresholdX)&&this.fire("swiperight",t)),this.swipedVertical&&(i<0?(this.velocityY<-this.opts.velocityThreshold||i<-this.disregardVelocityThresholdY)&&this.fire("swipeup",t):(this.velocityY>this.opts.velocityThreshold||i>this.disregardVelocityThresholdY)&&this.fire("swipedown",t))):e<this.opts.pressThreshold&&h<this.opts.pressThreshold&&(this.doubleTapWaiting?(this.doubleTapWaiting=!1,clearTimeout(this.doubleTapTimer),this.fire("doubletap",t)):(this.doubleTapWaiting=!0,this.doubleTapTimer=setTimeout(()=>this.doubleTapWaiting=!1,this.opts.doubleTapTime),this.fire("tap",t)))}}n.defaults={threshold:(r,t)=>Math.max(25,Math.floor(.15*(r==="x"?window.innerWidth||document.body.clientWidth:window.innerHeight||document.body.clientHeight))),velocityThreshold:10,disregardVelocityThreshold:(r,t)=>Math.floor(.5*(r==="x"?t.element.clientWidth:t.element.clientHeight)),pressThreshold:8,diagonalSwipes:!1,diagonalLimit:Math.tan(45*1.5/180*Math.PI),longPressTime:500,doubleTapTime:300,mouseSupport:!0};let o=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){o={passive:!0}}}))}catch{}export{n as T};
